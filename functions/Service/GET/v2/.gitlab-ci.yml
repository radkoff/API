 
Test GET /service/v2:
  stage: test_functions
  image: node:16
  script:
    - cd "functions/Service/GET/v2"
    - npm install
    - npm run build
  rules:
      - changes:
        - functions/Service/GET/v2/**/*
        
Staging GET /service/v2:
  stage: deploy_functions
  image: node:16
  script:
    - npm i -g appwrite-cli && appwrite client --endpoint $APPWRITE_HOSTNAME_STAGING --projectId $APPWRITE_PROJECT --key $APPWRITE_API_KEY
    - appwrite deploy function --functionId 6492c9a9ccf500f2220c
  environment: staging/get_service_v1
  needs:
    - Test GET /service/v2
  rules:
      - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH
        changes:
        - functions/Service/GET/v2/**/*

        
Production GET /service/v2:
  stage: deploy_functions
  image: node:16
  script:
    - npm i -g appwrite-cli && appwrite client --endpoint $APPWRITE_HOSTNAME_PROD --projectId $APPWRITE_PROJECT --key $APPWRITE_API_KEY
    - appwrite deploy function --functionId 6492c9a9ccf500f2220c
  environment: production/get_service_v1
  rules:
      - if: $CI_COMMIT_BRANCH == $CI_DEFAULT_BRANCH
        changes:
        - functions/Service/GET/v2/**/*
        when: manual
